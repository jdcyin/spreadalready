<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>spreadalready</title>
  <meta content="width=device-width, initial-scale=1" name="viewport" />

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Bitter:wght@400;700&display=swap" rel="stylesheet" />

  <!-- Leaflet CSS -->
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""
  />

  <!-- Fonts-only stylesheet -->
  <link rel="stylesheet" href="styles.css" />

  <style>
    html, body { height: 100%; margin: 0; padding: 0; }
    #map { height: 100%; width: 100%; }
    [hidden] { display: none !important; }

    /* ABOUT button */
    .about-link {
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 1000;
      background: rgba(255, 215, 0, 0.42);
      color: #000;
      padding: 8px 16px;
      border-radius: 10px;
      text-decoration: none;
      font-weight: 700;
      letter-spacing: 0.5px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.18);
      transition: background 0.2s ease;
      border: 1px solid rgba(0,0,0,0.06);
    }
    .about-link:hover { background: rgba(255, 215, 0, 0.55); }

    /* ABOUT overlay (modal) */
    .overlay {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 1100;
      background: rgba(255, 215, 0, 0.42);
      color: #000;
      padding: 24px 28px;
      max-width: 700px;
      border-radius: 12px;
      box-shadow: 0 12px 36px rgba(0,0,0,0.18);
      text-align: center;
    }

    .overlay-close {
      position: absolute;
      top: 8px;
      right: 10px;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      border: 1px solid rgba(0,0,0,0.1);
      background: rgba(255, 215, 0, 0.42);
      color: #000;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 18px;
      font-weight: 700;
      box-shadow: 0 3px 10px rgba(0,0,0,0.12);
      transition: background 0.2s ease, transform 0.08s ease;
    }
    .overlay-close:hover { background: rgba(255, 215, 0, 0.55); }
    .overlay-close:active { transform: scale(0.96); }

    /* Popup styling (matches ABOUT box) */
    .leaflet-popup-content-wrapper {
      background: rgba(255, 215, 0, 0.42);
      color: #000;
      border-radius: 10px;
      box-shadow: 0 3px 12px rgba(0,0,0,0.25);
    }
    .leaflet-popup-content {
      color: #000;
      font-family: 'Bitter', serif;
      font-size: 16px;
      line-height: 1.45;
    }
  </style>
</head>

<body>
  <!-- ABOUT button -->
  <a href="#" class="about-link" id="aboutBtn" role="button" aria-haspopup="dialog" aria-controls="aboutOverlay">ABOUT</a>

  <!-- ABOUT overlay -->
  <div class="overlay" id="aboutOverlay" role="dialog" aria-labelledby="aboutTitle" aria-modal="true" hidden>
    <button class="overlay-close" id="closeOverlay" aria-label="Close about">×</button>
    <h2 id="aboutTitle">SPREAD ALREADY</h2>
    <p><br>
      Curating the cheeses I've eaten<br><br>
      jy@spreadalready.com
    </p>
  </div>

  <!-- Map -->
  <div id="map"></div>

  <!-- Leaflet JS -->
  <script
    src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
    crossorigin=""
  ></script>

  <script>
    // 1) Structured cheese data (uses local /images folder)
    const cheeses = [
      {
        name: 'Comté Réserve',
        lat: 22.442322,
        lng: 114.165506,
        region: 'Jura, France',
        picture: 'images/comte.jpg',
        thoughts: 'Dense and nutty with browned-butter sweetness and a long, savoury finish.'
      },
      {
        name: 'Parmigiano Reggiano',
        lat: 22.340714,
        lng: 114.205352,
        region: 'Emilia-Romagna, Italy',
        picture: 'images/parmigiano.jpg',
        thoughts: 'Crystalline crunch, umami-rich; excellent grated or eaten in shards.'
      },
      {
        name: 'Manchego Curado',
        lat: 22.442874,
        lng: 114.096066,
        region: 'La Mancha, Spain',
        picture: 'images/manchego.jpg',
        thoughts: 'Buttery with a hint of lanolin; firm paste and gentle sweetness.'
      },
      {
        name: 'Brie de Meaux',
        lat: 22.415055,
        lng: 114.380035,
        region: 'Île-de-France, France',
        picture: 'images/brie.jpg',
        thoughts: 'Mushroomy rind, rich creamline; oozy at peak with a vegetal finish.'
      },
      {
        name: 'Roquefort',
        lat: 22.396809,
        lng: 114.252896,
        region: 'Aveyron, France',
        picture: 'images/roquefort.JPG',
        thoughts: 'Salty blue veins, peppery bite, and a lingering mineral tang.'
      }
    ];

    // 2) Marker icon helpers
    // PRESET COLOURS (uses the Leaflet color markers repo)
    function markerIcon(color = 'yellow') {
      return new L.Icon({
        iconUrl: `https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-${color}.png`,
        shadowUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png',
        iconSize: [25, 41],
        iconAnchor: [12, 41],
        popupAnchor: [1, -34],
        shadowSize: [41, 41]
      });
    }

    // CUSTOM HEX via SVG (use any color like '#FF5A5F')
    function svgPin(fill = '#FFD700') {
      const svg = encodeURIComponent(`
        <svg xmlns="http://www.w3.org/2000/svg" width="25" height="41" viewBox="0 0 25 41">
          <path fill="${fill}" d="M12.5 0C5.6 0 0 5.6 0 12.5S12.5 41 12.5 41 25 19.4 25 12.5C25 5.6 19.4 0 12.5 0z"/>
          <circle cx="12.5" cy="12.5" r="5.5" fill="white"/>
        </svg>
      `);
      return L.icon({
        iconUrl: `data:image/svg+xml;charset=UTF-8,${svg}`,
        iconSize: [25, 41],
        iconAnchor: [12, 41],
        popupAnchor: [1, -34]
      });
    }

    // === CHANGE MARKER COLOUR HERE ===
    // Use a preset: 'blue', 'red', 'green', 'orange', 'yellow', 'violet', 'grey', 'black'
    const pin = markerIcon('yellow');
    // Or use any hex color:
    // const pin = svgPin('#FFD700');

    // 3) Initialise map
    const map = L.map('map');
    L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
      maxZoom: 19,
      attribution: '&copy; OpenStreetMap contributors &copy; CARTO'
    }).addTo(map);

    const group = L.featureGroup().addTo(map);

    // 4) Render popup HTML dynamically
    function renderPopup(entry) {
      const imgHtml = entry.picture
        ? `<img src="${entry.picture}" alt="${entry.name}" style="max-width:100%;border-radius:6px;margin:6px 0;">`
        : '';
      return `
        <div>
          <div><b>Cheese name:</b> ${entry.name}</div>
          <div><b>Region:</b> ${entry.region || '—'}</div>
          <div><b>Picture:</b></div>
          ${imgHtml}
          <div><b>Tasting thoughts:</b> ${entry.thoughts || '—'}</div>
        </div>
      `;
    }

    // 5) Add markers and popups
    cheeses.forEach((c) => {
      L.marker([c.lat, c.lng], { icon: pin })
        .addTo(group)
        .bindPopup(renderPopup(c));
    });

    // 6) Initial view: entire world visible, centred on Czechia
    // Czechia approx centre: 49.8175 N, 15.4730 E
    map.setView([49.8175, 15.4730], 3);

    // 7) ABOUT overlay logic
    const aboutBtn = document.getElementById('aboutBtn');
    const aboutOverlay = document.getElementById('aboutOverlay');
    const closeOverlay = document.getElementById('closeOverlay');

    aboutBtn.addEventListener('click', (e) => {
      e.preventDefault();
      aboutOverlay.hidden = false;
      closeOverlay.focus();
    });

    closeOverlay.addEventListener('click', () => {
      aboutOverlay.hidden = true;
      aboutBtn.focus();
    });

    document.addEventListener('keydown', (e) => {
      if (!aboutOverlay.hidden && (e.key === 'Escape' || e.key === 'Esc')) {
        aboutOverlay.hidden = true;
        aboutBtn.focus();
      }
    });
  </script>
</body>
</html>
